{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "DataVerseToSQL"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/ww_hourlylabellinglogsheet')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Hourly Labelling Logsheet",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_acceptablefinish",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_acceptablefinish",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_alchoholna",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_alchoholna",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_backlabelheight",
											"type": "String"
										},
										"sink": {
											"name": "ww_backlabelheight",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_backlabelleanlessthan1mmltor",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_backlabelleanlessthan1mmltor",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_backlabellotcodeinkjet",
											"type": "String"
										},
										"sink": {
											"name": "ww_backlabellotcodeinkjet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_backlabellotcodeinkjetcodesampletaken",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_backlabellotcodeinkjetcodesampletaken",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_backlabellotcodeinkjethourlycodecheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_backlabellotcodeinkjethourlycodecheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_barcodecheckdigit",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_barcodecheckdigit",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_barcodena",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_barcodena",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_bloweron",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_bloweron",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_bottleandcapscleansig",
											"type": "String"
										},
										"sink": {
											"name": "ww_bottleandcapscleansig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_caronvarietyvintage",
											"type": "String"
										},
										"sink": {
											"name": "ww_caronvarietyvintage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonalcoholpercentage",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_cartonalcoholpercentage",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_cartonbarcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_cartonbarcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_cartonclosurelessthan10mm",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_cartonclosurelessthan10mm",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_cartoncode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_cartoncode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_cartoncountry",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartoncountry",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartoneanplacementsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartoneanplacementsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonfibretear",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_cartonfibretear",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_cartoninkjetcorrectcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_cartoninkjetcorrectcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_cartonlabel",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartonlabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonlabelsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartonlabelsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonlotcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartonlotcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonoperatorcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartonoperatorcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonrunnumber",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartonrunnumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonskewlessthan10mm",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_cartonskewlessthan10mm",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_cartonssig",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartonssig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonweightrange",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_cartonweightrange",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_checkweighersetpoint",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_checkweighersetpoint",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_closuresacceptablefinishsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_closuresacceptablefinishsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_comments",
											"type": "String"
										},
										"sink": {
											"name": "ww_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_correctcolourprint",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_correctcolourprint",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_countofsamplestaken",
											"type": "String"
										},
										"sink": {
											"name": "ww_countofsamplestaken",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_dividersils",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_dividersils",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_dividerused",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_dividerused",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_edgeadhesiontestpass",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_edgeadhesiontestpass",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_fourthlabelheightposition",
											"type": "String"
										},
										"sink": {
											"name": "ww_fourthlabelheightposition",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_hourlylabellinglogsheetid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_hourlylabellinglogsheetid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_key",
											"type": "String"
										},
										"sink": {
											"name": "ww_key",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labelalcoholfrontbackcheckedsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_labelalcoholfrontbackcheckedsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labelbarcodecheckdigit",
											"type": "String"
										},
										"sink": {
											"name": "ww_labelbarcodecheckdigit",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labeldamageruborpick",
											"type": "String"
										},
										"sink": {
											"name": "ww_labeldamageruborpick",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labelfrontheight",
											"type": "String"
										},
										"sink": {
											"name": "ww_labelfrontheight",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labelleanlessthan1mmltor",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_labelleanlessthan1mmltor",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_labelnationalityfrontbackcorrectsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_labelnationalityfrontbackcorrectsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labelssig",
											"type": "String"
										},
										"sink": {
											"name": "ww_labelssig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_lasercode",
											"type": "String"
										},
										"sink": {
											"name": "ww_lasercode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labelvarietyvintagecheckedsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_labelvarietyvintagecheckedsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_lasercodeclearandlegiblesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_lasercodeclearandlegiblesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_palletnumber",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_palletnumber",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_palletoperatorcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_palletoperatorcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_palletstackingpattern",
											"type": "String"
										},
										"sink": {
											"name": "ww_palletstackingpattern",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_palletstackingpatternmatchessig",
											"type": "String"
										},
										"sink": {
											"name": "ww_palletstackingpatternmatchessig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_palletsticker",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_palletsticker",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_palletstidysig",
											"type": "String"
										},
										"sink": {
											"name": "ww_palletstidysig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_pallettypesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_pallettypesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rdlabel",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_rdlabel",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_sidegaplessthat4mm",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_sidegaplessthat4mm",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_sidegap1",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_sidegap1",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_sidegap2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_sidegap2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_slipsheetscorrectplacement",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_slipsheetscorrectplacement",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_thirdlabelheightposition",
											"type": "String"
										},
										"sink": {
											"name": "ww_thirdlabelheightposition",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_thlabel",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_thlabel",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_wrinklesflutesbubblesorcreases",
											"type": "String"
										},
										"sink": {
											"name": "ww_wrinklesflutesbubblesorcreases",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "HourlyLabellingLogsheet",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_hourlylabellinglogsheet",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Hourly Labelling Logsheet",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_hourlylabellinglogsheet]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Hourly Labelling Logsheet",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_hourlylabellinglogsheet]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2021-04-13T20:25:07Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_hourlytorqueandvolume')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Hourly Torque and Volume",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "crc5d_density",
											"type": "Decimal"
										},
										"sink": {
											"name": "crc5d_density",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "crc5d_radialmovementchecksig",
											"type": "String"
										},
										"sink": {
											"name": "crc5d_radialmovementchecksig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "crc5d_redrawsealcheck",
											"type": "String"
										},
										"sink": {
											"name": "crc5d_redrawsealcheck",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "new_customertank",
											"type": "String"
										},
										"sink": {
											"name": "new_customertank",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_adjustment",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_adjustment",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_adjustmenthasbeenmadesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_adjustmenthasbeenmadesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_averageweight",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_averageweight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_averagevolume",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_averagevolume",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_balancecheck",
											"type": "String"
										},
										"sink": {
											"name": "ww_balancecheck",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_bucketflowedtime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_bucketflowedtime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_bucketskegsflowedintime",
											"type": "String"
										},
										"sink": {
											"name": "ww_bucketskegsflowedintime",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_capcoloursig",
											"type": "String"
										},
										"sink": {
											"name": "ww_capcoloursig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_capilscodesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_capilscodesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_capprintingsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_capprintingsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_colour",
											"type": "String"
										},
										"sink": {
											"name": "ww_colour",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_colourcheckedsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_colourcheckedsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_comments",
											"type": "String"
										},
										"sink": {
											"name": "ww_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corkbaseclearofcorksforeignmatter",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_corkbaseclearofcorksforeignmatter",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_corkbrandingsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_corkbrandingsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corkcolour",
											"type": "String"
										},
										"sink": {
											"name": "ww_corkcolour",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corkcolourcheckedsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_corkcolourcheckedsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corkdepthaftermuselet",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_corkdepthaftermuselet",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_corkilscodesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_corkilscodesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corkinsertion",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_corkinsertion",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_corkinsertionchecked",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_CorkInsertionChecked",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_corkinsertionsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_corkinsertionsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corklengthsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_corklengthsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corkmoisturereading",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_Corkmoisturereading",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_corkmoisturesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_corkmoisturesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corkplungedepth",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_corkplungedepth",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_corkprintingsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_corkprintingsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_datetime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_datetime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight1",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight1",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight10",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight10",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight11",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight11",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight12",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight12",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight3",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight4",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight4",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight5",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight5",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight6",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight6",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight7",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight7",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight8",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight8",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_emptybottleweight9",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_emptybottleweight9",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillheight1",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_fillheight1",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_fillheight10",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillheight10",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillheight11",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillheight11",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillheight12",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillheight12",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillheight2",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_fillheight2",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_fillheight3",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_fillheight3",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_fillheight4",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_fillheight4",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_fillheight5",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_fillheight5",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_fillheight6",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillheight6",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillheight7",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillheight7",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillheight8",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillheight8",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillheight9",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillheight9",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_flowedfrom",
											"type": "String"
										},
										"sink": {
											"name": "ww_flowedfrom",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_flowedto",
											"type": "String"
										},
										"sink": {
											"name": "ww_flowedto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight1",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight1",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight10",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight10",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight11",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight11",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight12",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight12",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight3",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight4",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight4",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight5",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight5",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight6",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight6",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight7",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight7",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight8",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight8",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fullbottleweight9",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fullbottleweight9",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_gapingbrokenbridges",
											"type": "String"
										},
										"sink": {
											"name": "ww_gapingbrokenbridges",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_grossweight",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_grossweight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_headspacemeasurement",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_HeadSpaceMeasurement",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_headspacemeasurementsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_headspacemeasurementsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_headspacepressuremeasurement",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_HeadSpacePressureMeasurement",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_headspacemeasurementcomments",
											"type": "String"
										},
										"sink": {
											"name": "ww_HeadSpaceMeasurementComments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_headspacepressuresig",
											"type": "String"
										},
										"sink": {
											"name": "ww_headspacepressuresig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_hourlytorqueandvolumeid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_hourlytorqueandvolumeid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_inversiontesttocheckforleakers",
											"type": "String"
										},
										"sink": {
											"name": "ww_inversiontesttocheckforleakers",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_isthemuseletsecure",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_isthemuseletsecure",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_isthemuseletuniform",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_isthemuseletuniform",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_isthetieupright",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_isthetieupright",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_key",
											"type": "String"
										},
										"sink": {
											"name": "ww_key",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_museletbaseclearofmuseletsfm",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_museletbaseclearofmuseletsfm",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_nettweight",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_nettweight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_printing",
											"type": "String"
										},
										"sink": {
											"name": "ww_printing",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_printingcheckedsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_printingcheckedsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_productcheckedandmatches",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productcheckedandmatches",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_pulltucktest",
											"type": "String"
										},
										"sink": {
											"name": "ww_pulltucktest",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_pulltucktestchecked",
											"type": "String"
										},
										"sink": {
											"name": "ww_pulltucktestchecked",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rimimpression",
											"type": "String"
										},
										"sink": {
											"name": "ww_rimimpression",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_screwcapperchutecheckedsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_screwcapperchutecheckedsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_screwcapperchutesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_screwcapperchutesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_sparkling",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_sparkling",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_stockcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_stockcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_stockcodecheckedsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_stockcodecheckedsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight1",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight1",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight10",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight10",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight11",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight11",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight12",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight12",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight3",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight4",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight4",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight5",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight5",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight6",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight6",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight7",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight7",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight8",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight8",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tafillheight9",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tafillheight9",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tankchangedflowedintime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_tankchangedflowedintime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_tanker",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_tanker",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_tareweight",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tareweight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak1",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak1",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak10",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak10",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak2",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak2",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak3",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak3",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak4",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak4",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak5",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak5",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak6",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak6",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak7",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak7",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak8",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak8",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquebreak9",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torquebreak9",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torquecap1",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torquecap10",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap10",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torquecap2",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torquecap3",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torquecap4",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torquecap5",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torquecap6",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torquecap7",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torquecap8",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap8",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torquecap9",
											"type": "String"
										},
										"sink": {
											"name": "ww_torquecap9",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip1",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip1",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip10",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip10",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip2",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip2",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip3",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip3",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip4",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip4",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip5",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip5",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip6",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip6",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip7",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip7",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip8",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip8",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_torqueslip9",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_torqueslip9",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_visualsealonbottle",
											"type": "String"
										},
										"sink": {
											"name": "ww_visualsealonbottle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_winetemperature",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_winetemperature",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_zorksealcheckok",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_zorksealcheckok",
											"type": "Boolean"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "HourlyTorqueandVolume",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SqlServerTable11",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Hourly Torque and Volume",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_hourlytorqueandvolume]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Hourly Torque and Volume",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_hourlytorqueandvolume]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_labelchange')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Label Change",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterial",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterial",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_gap",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_gap",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_gapback",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_gapback",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_height",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_height",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_heightback",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_heightback",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_labelchangeid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_labelchangeid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_labelsmatchspecsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_labelsmatchspecsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labelsperroll",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_labelsperroll",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_lean",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_lean",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_name",
											"type": "String"
										},
										"sink": {
											"name": "ww_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_palletnumber",
											"type": "String"
										},
										"sink": {
											"name": "ww_palletnumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_stockcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_stockcode",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "LabelChange",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_labelchange",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Label Change",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_labelchange]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Label Change",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_labelchange]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_labellingissues')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Labelling Issues",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_bottlerub",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlerub",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_brokenbottles",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_brokenbottles",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_cartonsrejected",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_cartonsrejected",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_comments",
											"type": "String"
										},
										"sink": {
											"name": "ww_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_damagedscrewcaps",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_damagedscrewcaps",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_datetime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_datetime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_deleteissue",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteissue",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_deleterejects",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleterejects",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_glassdefect",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_glassdefect",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_issue",
											"type": "String"
										},
										"sink": {
											"name": "ww_issue",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labellingissue",
											"type": "String"
										},
										"sink": {
											"name": "ww_labellingissue",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labellingissuesid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_labellingissuesid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_lowfills",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_lowfills",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_totalrejects",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_totalrejects",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "LabellingIssues",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_labellingissues",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Labelling Issues",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_labellingissues]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Labelling Issues",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_labellingissues]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_labellingpreflight')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Labelling Preflight",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "crc5d_lasercodecheck",
											"type": "String"
										},
										"sink": {
											"name": "crc5d_lasercodecheck",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_backlabel",
											"type": "String"
										},
										"sink": {
											"name": "ww_backlabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_backlabeladditionaltext",
											"type": "String"
										},
										"sink": {
											"name": "ww_backlabeladditionaltext",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_backlabelinkjetcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_backlabelinkjetcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_backlabelinkjetplacement",
											"type": "String"
										},
										"sink": {
											"name": "ww_backlabelinkjetplacement",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_barcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_barcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterialsinstructionsforthisrun",
											"type": "String"
										},
										"sink": {
											"name": "ww_billofmaterialsinstructionsforthisrun",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterialsspecificinstructions",
											"type": "String"
										},
										"sink": {
											"name": "ww_billofmaterialsspecificinstructions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bom3rdlabel",
											"type": "String"
										},
										"sink": {
											"name": "ww_bom3rdlabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bom3rdlabelposition",
											"type": "String"
										},
										"sink": {
											"name": "ww_bom3rdlabelposition",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bom4thlabel",
											"type": "String"
										},
										"sink": {
											"name": "ww_bom4thlabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bom4thlabelposition",
											"type": "String"
										},
										"sink": {
											"name": "ww_bom4thlabelposition",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bombacklabel",
											"type": "String"
										},
										"sink": {
											"name": "ww_bombacklabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bombacklabelheight",
											"type": "String"
										},
										"sink": {
											"name": "ww_bombacklabelheight",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bombacklabelinkjetcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_bombacklabelinkjetcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomcartoncode",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomcartoncode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomcartoninkjet",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomcartoninkjet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomcartoninkjetplacement",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomcartoninkjetplacement",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomcartonlabelinstruction",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomcartonlabelinstruction",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomcartonlabeltype",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomcartonlabeltype",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomextraitem",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomextraitem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomextraitem2",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomextraitem2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomfrontlabel",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomfrontlabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomfrontlabelheight",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomfrontlabelheight",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomgenericinstruction",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomgenericinstruction",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bominstructionsforthisrun",
											"type": "String"
										},
										"sink": {
											"name": "ww_bominstructionsforthisrun",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomlabeladditionaltext",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomlabeladditionaltext",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomlabelinkjetplacement",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomlabelinkjetplacement",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bompalletstackingpattern",
											"type": "String"
										},
										"sink": {
											"name": "ww_bompalletstackingpattern",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomslipsheet",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomslipsheet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomspecificinstructions",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomspecificinstructions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bomworkorderinstructions",
											"type": "String"
										},
										"sink": {
											"name": "ww_bomworkorderinstructions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonilscode",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartonilscode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartoninkjet",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartoninkjet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartoninkjetplacement",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartoninkjetplacement",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonlabels",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartonlabels",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartons",
											"type": "String"
										},
										"sink": {
											"name": "ww_cartons",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cartonscheckedandmatches",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_cartonscheckedandmatches",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_caseerectoroverpackerscissorscheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_caseerectoroverpackerscissorscheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_caselabellerscissorscheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_caselabellerscissorscheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_ccp3rdlabelmatchesimageonspec",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_CCP3rdlabelmatchesimageonspec",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_ccp4thlabelmatchesimageonspec",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_CCP4thlabelmatchesimageonspec",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_ccpbacklabelmatchesimageonspec",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_CCPbacklabelmatchesimageonspec",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_ccpfrontlabelmatchesimageonspec",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_CCPfrontlabelmatchesimageonspec",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_cleanskin",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_cleanskin",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_closuresilscodecorrectsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_closuresilscodecorrectsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_comments",
											"type": "String"
										},
										"sink": {
											"name": "ww_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_divider",
											"type": "String"
										},
										"sink": {
											"name": "ww_divider",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_dividersilscode",
											"type": "String"
										},
										"sink": {
											"name": "ww_dividersilscode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_dividersscissorscheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_dividersscissorscheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_dividerused",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_dividerused",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_extraitem",
											"type": "String"
										},
										"sink": {
											"name": "ww_extraitem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_extraitem2",
											"type": "String"
										},
										"sink": {
											"name": "ww_extraitem2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_fourthlabel",
											"type": "String"
										},
										"sink": {
											"name": "ww_fourthlabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_frontlabel",
											"type": "String"
										},
										"sink": {
											"name": "ww_frontlabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_genericclientinstructions",
											"type": "String"
										},
										"sink": {
											"name": "ww_genericclientinstructions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_labeldetectionon",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_labeldetectionon",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_labellerscissorscheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_labellerscissorscheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_labellingpreflightid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_labellingpreflightid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_labelpositionamended",
											"type": "String"
										},
										"sink": {
											"name": "ww_labelpositionamended",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_lasercodeonbottle",
											"type": "String"
										},
										"sink": {
											"name": "ww_lasercodeonbottle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_lineclearfrompreviousjob",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_lineclearfrompreviousjob",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_name",
											"type": "String"
										},
										"sink": {
											"name": "ww_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_pallet",
											"type": "String"
										},
										"sink": {
											"name": "ww_pallet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_palletnumber",
											"type": "String"
										},
										"sink": {
											"name": "ww_palletnumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_palletscorrecttospec",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_palletscorrecttospec",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_pallettypecheckedsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_pallettypecheckedsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_sampleattachedtospec",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_sampleattachedtospec",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_slipsheet",
											"type": "String"
										},
										"sink": {
											"name": "ww_slipsheet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_stacking",
											"type": "String"
										},
										"sink": {
											"name": "ww_stacking",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_startupinitial",
											"type": "String"
										},
										"sink": {
											"name": "ww_startupinitial",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_startuptime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_startuptime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_thirdlabel",
											"type": "String"
										},
										"sink": {
											"name": "ww_thirdlabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_uv",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_uv",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_varietyvintage",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_varietyvintage",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_weighalarmon",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_weighalarmon",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_workorderinstructions",
											"type": "String"
										},
										"sink": {
											"name": "ww_workorderinstructions",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "LabellingPreflight",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_labellingpreflight",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Labelling Preflight",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_LabellingPreflight]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Labelling Preflight",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_labellingpreflight]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_operator')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Operator",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_code",
											"type": "String"
										},
										"sink": {
											"name": "ww_code",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_initials",
											"type": "String"
										},
										"sink": {
											"name": "ww_initials",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_operatorid",
											"type": "Guid"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Operator",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_operator",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Operator",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_Operator]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Operator",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_operator]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_operatorbottlingbreakage')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Operator Bottling Breakage",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_areaclean",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_areaclean",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_arearetimed",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_arearetimed",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_bottlecount",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlecount",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_breakagelocation",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_breakagelocation",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_breakages",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_breakages",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_brokenbottles",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_brokenbottles",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_colleaguesign",
											"type": "String"
										},
										"sink": {
											"name": "ww_colleaguesign",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_comments",
											"type": "String"
										},
										"sink": {
											"name": "ww_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_disposedbottles",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_disposedbottles",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_filleropsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_filleropsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_locationofbreak",
											"type": "String"
										},
										"sink": {
											"name": "ww_locationofbreak",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_name",
											"type": "String"
										},
										"sink": {
											"name": "ww_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_nobreakagessig",
											"type": "String"
										},
										"sink": {
											"name": "ww_nobreakagessig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorbottlingbreakageid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_operatorbottlingbreakageid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_resultofacrash",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_resultofacrash",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_startuptime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_startuptime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_timeofbreak",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_timeofbreak",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_type",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_type",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_typeofglassbreak",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_typeofglassbreak",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "OperatorBottlingBreakage",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_operatorbottlingbreakage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Operator Bottling Breakage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "usp_ww_operatorbottlingbreakage"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Operator Bottling Breakage",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_operatorbottlingbreakage]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_operatorbottlingdowntime')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Operator Bottling Downtime",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_name",
											"type": "String"
										},
										"sink": {
											"name": "ww_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorbottlingdowntimeid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_operatorbottlingdowntimeid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_reason",
											"type": "String"
										},
										"sink": {
											"name": "ww_reason",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_start",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_start",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_stop",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_stop",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_totalminutes",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_totalminutes",
											"type": "Decimal"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "OperatorBottlingDowntime",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_operatorbottlingdowntime",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Operator Bottling Downtime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "usp_ww_operatorbottlingdowntime"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Operator Bottling Downtime",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_operatorbottlingdowntime]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_operatorbottlinghourly')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Hourly Operator Bottling",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_authorisedsig",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_authorisedsig",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_autolevelmanometer",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_autolevelmanometer",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_bardifferential",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_bardifferential",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_bottlecodesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_bottlecodesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bottlecoloursig",
											"type": "String"
										},
										"sink": {
											"name": "ww_bottlecoloursig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bottlelasersticker",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlelasersticker",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_bottlelaserstickersig",
											"type": "String"
										},
										"sink": {
											"name": "ww_bottlelaserstickersig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bottlenumberasperlasercoder",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlenumberasperlasercoder",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_bottlerubmark",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlerubmark",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_bottleshapesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_bottleshapesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bottlevacuum",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_bottlevacuum",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_bottlevacuumaccordingtorecipe",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_bottlevacuumaccordingtorecipe",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_bottlingfrom",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlingfrom",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_bottlingto",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlingto",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_bowlmn2pressure",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_bowlmn2pressure",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_bowlvacuum",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_bowlvacuum",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_bucketsflowedintime",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_bucketsflowedintime",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_bucketsflowedtime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_bucketsflowedtime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_capdetectoronsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_capdetectoronsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_charmattankc02",
											"type": "String"
										},
										"sink": {
											"name": "ww_charmattankc02",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_checkdocketandphysicallycheckwineisrun",
											"type": "String"
										},
										"sink": {
											"name": "ww_checkdocketandphysicallycheckwineisrun",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_chippednecks",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_chippednecks",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_closuretypechecked",
											"type": "String"
										},
										"sink": {
											"name": "ww_closuretypechecked",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_co2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_co2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_collectexportsamples",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_collectexportsamples",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_corkinsertion",
											"type": "String"
										},
										"sink": {
											"name": "ww_corkinsertion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corkerclearance",
											"type": "String"
										},
										"sink": {
											"name": "ww_corkerclearance",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_corkervacuum",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_corkervacuum",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_corkervacuum08to10bar",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_corkervacuum08to10bar",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_counterpressureinlet",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_counterpressureinlet",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_counterpressureoutlet",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_counterpressureoutlet",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_datecurrentbottleopened",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_Datecurrentbottleopened",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_deoxn2pressre",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_deoxn2pressre",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_deoxvacuumpressure",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_deoxvacuumpressure",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_dissolvedc02inbottle",
											"type": "String"
										},
										"sink": {
											"name": "ww_dissolvedc02inbottle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_do2frombottle",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_do2frombottle",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_do2fromvessel",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_do2fromvessel",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_exportsamplespicked",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_exportsamplespicked",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_fillerbowlpressure",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillerbowlpressure",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillerbowltemperature",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_fillerbowltemperature",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_fillerhead",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillerhead",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillerspeed",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_fillerspeed",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_fillertemperature40c",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_fillertemperature40c",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_fillertipsealsvisualchecksig",
											"type": "String"
										},
										"sink": {
											"name": "ww_fillertipsealsvisualchecksig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_fillheight",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fillheight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fillheightchallengetested",
											"type": "String"
										},
										"sink": {
											"name": "ww_fillheightchallengetested",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_fillheightdetectoronsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_fillheightdetectoronsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_filterdifferential",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_filterdifferential",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_filtrationpressuregauge",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_filtrationpressuregauge",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_finalfilter",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_finalfilter",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_flowmetercheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_flowmetercheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_flowedfrom",
											"type": "String"
										},
										"sink": {
											"name": "ww_flowedfrom",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_flowedto",
											"type": "String"
										},
										"sink": {
											"name": "ww_flowedto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_foreignbodyvisualcheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_foreignbodyvisualcheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_foreignmattersig",
											"type": "String"
										},
										"sink": {
											"name": "ww_foreignmattersig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_gasblowonbottle",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_gasblowonbottle",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_gascoveronbowl",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_gascoveronbowl",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_gasfeedtocorker",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_gasfeedtocorker",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_gasfeedtocorker1030kpa",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_gasfeedtocorker1030kpa",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "crc5d_gasfirstblow",
											"type": "Decimal"
										},
										"sink": {
											"name": "crc5d_gasfirstblow",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_gasflowratetobowlline2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_gasflowratetobowlline2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_gasflowtocap",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_gasflowtocap",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_gaspressuretobottlingtank",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_gaspressuretobottlingtank",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_glassfragments",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_glassfragments",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_glassfragmentscheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_glassfragmentscheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_glassfragmentsexplanation",
											"type": "String"
										},
										"sink": {
											"name": "ww_glassfragmentsexplanation",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "crc5d_glassfragmentswithblank",
											"type": "Int32"
										},
										"sink": {
											"name": "crc5d_glassfragmentswithblank",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_headspacemeasurement",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_headspacemeasurement",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_headspacepressure",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_headspacepressure",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_inbottle",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_inbottle",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_intank",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_intank",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_inertgaspressure",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_inertgaspressure",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_kegsflowedintime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_kegsflowedintime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_knifebladecheck",
											"type": "String"
										},
										"sink": {
											"name": "ww_knifebladecheck",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_lasercodeasperspec",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_lasercodeasperspec",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_lasercodeonbottle",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_lasercodeonbottle",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_lenticularfilter",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_lenticularfilter",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_lenticularfilteroptions",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_LenticularFilteroptions",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_litmuspapertestinproduct",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_litmuspapertestinproduct",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_n2buffervesselpressure",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_n2buffervesselpressure",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_name",
											"type": "String"
										},
										"sink": {
											"name": "ww_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_neckcheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_neckcheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_notes",
											"type": "String"
										},
										"sink": {
											"name": "ww_notes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_numberofforeignbodiespresent",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_numberofforeignbodiespresent",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_numberofkegs",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_numberofkegs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_operatorbottlinghourlyid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_operatorbottlinghourlyid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_palletnumber",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_palletnumber",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_pittingsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_pittingsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_prefilter",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_prefilter",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_prepcheck2",
											"type": "String"
										},
										"sink": {
											"name": "ww_prepcheck2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_prepcheck3",
											"type": "String"
										},
										"sink": {
											"name": "ww_prepcheck3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_productcheckedandmatches",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productcheckedandmatches",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_prepchecksig",
											"type": "String"
										},
										"sink": {
											"name": "ww_prepchecksig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_pumpnumber",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_pumpnumber",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_pumpnumberbendpanel",
											"type": "String"
										},
										"sink": {
											"name": "ww_pumpnumberbendpanel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_pumpspeed",
											"type": "String"
										},
										"sink": {
											"name": "ww_pumpspeed",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rimdetectionlighton",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_rimdetectionlighton",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_rinseheadinspection",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_rinseheadinspection",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_rinseheadmedium",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_rinseheadmedium",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_rinsejetcoveragesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_rinsejetcoveragesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rinserbottlegripperclearancesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_rinserbottlegripperclearancesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rinsercleanliness",
											"type": "String"
										},
										"sink": {
											"name": "ww_RinserCleanliness",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rinsercleanlinesssig",
											"type": "String"
										},
										"sink": {
											"name": "ww_RinserCleanlinessSig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rinsergassupplyco2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_rinsergassupplyco2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_rinsergaswatersupply",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_rinsergaswatersupply",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_rinsergaswatersupplyline1",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_rinsergaswatersupplyline1",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_rinsergaswatersupplyline2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_rinsergaswatersupplyline2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_rinsern2pressure",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_rinsern2pressure",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_rinserpressurefluctuations",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_rinserpressurefluctuations",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_rinsertipsvisualchecksig",
											"type": "String"
										},
										"sink": {
											"name": "ww_rinsertipsvisualchecksig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rinserwatersupply",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_rinserwatersupply",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_rinsewater045mprefilter",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_rinsewater045mprefilter",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_rinsewater12mprefilter",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_rinsewater12mprefilter",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_rockstopper",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_rockstopper",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_rockstopperfilter",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_rockstopperfilter",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_samplessig",
											"type": "String"
										},
										"sink": {
											"name": "ww_samplessig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_screencheckfordoserate",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_screencheckfordoserate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_selflevelling",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_selflevelling",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "crc5d_shakendorequired",
											"type": "Boolean"
										},
										"sink": {
											"name": "crc5d_shakendorequired",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "crc5d_shakendostartofrun",
											"type": "Decimal"
										},
										"sink": {
											"name": "crc5d_shakendostartofrun",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_sparkling",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_sparkling",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_stockcodesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_stockcodesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tankchangeflowedintimesig",
											"type": "String"
										},
										"sink": {
											"name": "ww_tankchangeflowedintimesig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tankgas",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tankgas",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tankjointscheckedfornleakssig",
											"type": "String"
										},
										"sink": {
											"name": "ww_tankjointscheckedfornleakssig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tankpressure",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tankpressure",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tanker",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_tanker",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_temperature",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_temperature",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_timeofauthorisedauditcheck",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_timeofauthorisedauditcheck",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_timeofcheckmicrosampletaken",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_timeofcheckmicrosampletaken",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_tkinjectionmanometer",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tkinjectionmanometer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_velcorinalarmssig",
											"type": "String"
										},
										"sink": {
											"name": "ww_velcorinalarmssig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_velcorincannisterbatch",
											"type": "String"
										},
										"sink": {
											"name": "ww_VelcorinCannisterBatch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_velcorincannisterchanged",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_Velcorincannisterchanged",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_velcorincannisterexpiry",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_VelcorinCannisterExpiry",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_velcorinchangebottlelightsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_velcorinchangebottlelightsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_velcorindosingrate",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_velcorindosingrate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_velcorntime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_velcorntime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_venttubecount",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_venttubecount",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_visualfloatiescheckedsig",
											"type": "String"
										},
										"sink": {
											"name": "ww_visualfloatiescheckedsig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_visualleakssig",
											"type": "String"
										},
										"sink": {
											"name": "ww_visualleakssig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_warmingtunnelrunningtemperature",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_warmingtunnelrunningtemperature",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_winetemperatureinternalprobe40c",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_winetemperatureinternalprobe40c",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_winetempinternalprobe",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_winetempinternalprobe",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_xraychallengetest",
											"type": "String"
										},
										"sink": {
											"name": "ww_xraychallengetest",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "HourlyOperatorBottling",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_operatorbottlinghourly2",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Hourly Operator Bottling",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_operatorbottlinghourly]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Data Copy fail email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Hourly Operator Bottling",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_operatorbottlinghourly]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_palletstacking')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Pallet Stacking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_cartoncount",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_cartoncount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_lpn",
											"type": "String"
										},
										"sink": {
											"name": "ww_lpn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_name",
											"type": "String"
										},
										"sink": {
											"name": "ww_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operator",
											"type": "String"
										},
										"sink": {
											"name": "ww_operator",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_palletnumber",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_palletnumber",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_palletstackingid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_PalletStackingId",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_psimportsequencenumber",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_psimportsequencenumber",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_stackingpattern",
											"type": "String"
										},
										"sink": {
											"name": "ww_stackingpattern",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "PalletStacking",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_palletstacking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Pallet Stacking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "usp_ww_palletstacking"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Pallet Stacking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_palletstacking]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_palletstackinghourly')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_palletstackinghourly]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Pallet stacking Hourly",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_billofmaterials",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_deleted",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleted",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_headcover",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_headcover",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_name",
											"type": "String"
										},
										"sink": {
											"name": "ww_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_palletnumber",
											"type": "String"
										},
										"sink": {
											"name": "ww_palletnumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_palletstackinghourlyid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_palletstackinghourlyid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_palletsticker",
											"type": "String"
										},
										"sink": {
											"name": "ww_palletsticker",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_pallettypechecked",
											"type": "String"
										},
										"sink": {
											"name": "ww_pallettypechecked",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_slipsheets",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_slipsheets",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_stackingpattern",
											"type": "String"
										},
										"sink": {
											"name": "ww_stackingpattern",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_tidy",
											"type": "String"
										},
										"sink": {
											"name": "ww_tidy",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_topsheet",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_topsheet",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "PalletstackingHourly",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_palletstackinghourly",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Email on Failure",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Pallet stacking Hourly",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure SP",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Pallet stacking Hourly",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_palletstackinghourly]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_prebottlinganalysis')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Pre-Bottling Analysis",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Stored procedure Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource",
								"query": "<fetch>\n  <entity name='ww_prebottlinganalysis'>\n    <attribute name='crc5d_refractvalue'/>\n    <attribute name='createdon'/>\n    <attribute name='modifiedon'/>\n    <attribute name='statuscode'/>\n    <attribute name='ww_alc'/>\n    <attribute name='ww_alcbydistil'/>\n    <attribute name='ww_alcnum'/>\n    <attribute name='ww_alcnumrackingvalve'/>\n    <attribute name='ww_alcohol'/>\n    <attribute name='ww_alcoholbydistillation'/>\n    <attribute name='ww_basedo'/>\n    <attribute name='ww_co2'/>\n    <attribute name='ww_customertankname'/>\n    <attribute name='ww_date'/>\n    <attribute name='ww_deleteline'/>\n    <attribute name='ww_density'/>\n    <attribute name='ww_etxt'/>\n    <attribute name='ww_fi'/>\n    <attribute name='ww_fiissueemailsent'/>\n    <attribute name='ww_greentag'/>\n    <attribute name='ww_initials'/>\n    <attribute name='ww_initialscheck'/>\n    <attribute name='ww_location'/>\n    <attribute name='ww_lockcode'/>\n    <attribute name='ww_lockid'/>\n    <attribute name='ww_notes'/>\n    <attribute name='ww_operator'/>\n    <attribute name='ww_operatorcode'/>\n    <attribute name='ww_ph'/>\n    <attribute name='ww_prebottlinganalysisid'/>\n    <attribute name='ww_prebottlinganalysissummaryname'/>\n    <attribute name='ww_productionline'/>\n    <attribute name='ww_reasonfordeletion'/>\n    <attribute name='ww_refract'/>\n    <attribute name='ww_run'/>\n    <attribute name='ww_sealid'/>\n    <attribute name='ww_sealnumber'/>\n    <attribute name='ww_so2f'/>\n    <attribute name='ww_tankerlookup'/>\n    <attribute name='ww_tankvolume'/>\n    <attribute name='ww_temp'/>\n    <attribute name='ww_temprackingvalve'/>\n    <attribute name='ww_ts02'/>\n    <attribute name='ww_ts02num'/>\n    <attribute name='ww_tso2'/>\n    <attribute name='ww_volumeunder500'/>\n    <filter type='and'>\n      <condition attribute='ww_tankerlookup' operator='not-null' />\n    </filter>\n  </entity>\n</fetch>\n"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "crc5d_refractvalue",
											"type": "Decimal"
										},
										"sink": {
											"name": "crc5d_refractvalue",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_alc",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_alc",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_alcbydistil",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_alcbydistil",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_alcnum",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_alcnum",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_alcnumrackingvalve",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_alcnumrackingvalve",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_alcohol",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_alcohol",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_alcoholbydistillation",
											"type": "String"
										},
										"sink": {
											"name": "ww_alcoholbydistillation",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_basedo",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_basedo",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_co2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_co2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_customertankname",
											"type": "String"
										},
										"sink": {
											"name": "ww_customertankname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_density",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_density",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_etxt",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_etxt",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_fi",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fi",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fiissueemailsent",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_fiissueemailsent",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_gatecode",
											"type": "String"
										},
										"sink": {
											"name": "ww_gatecode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_greentag",
											"type": "String"
										},
										"sink": {
											"name": "ww_greentag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_initials",
											"type": "String"
										},
										"sink": {
											"name": "ww_initials",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_initialscheck",
											"type": "String"
										},
										"sink": {
											"name": "ww_initialscheck",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_location",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_location",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_lockcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_lockcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_lockid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_lockid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_notes",
											"type": "String"
										},
										"sink": {
											"name": "ww_notes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operator",
											"type": "String"
										},
										"sink": {
											"name": "ww_operator",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "String"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_ph",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_ph",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_prebottlinganalysisid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_prebottlinganalysisid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_prebottlinganalysissummaryname",
											"type": "String"
										},
										"sink": {
											"name": "ww_prebottlinganalysissummaryname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_refract",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_refract",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_run",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_run",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_sealid",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_sealid",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_sealnumber",
											"type": "String"
										},
										"sink": {
											"name": "ww_sealnumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_so2f",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_so2f",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tankerlookup",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_tankerlookup",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_tankvolume",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_tankvolume",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_temp",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_temp",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tempcheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_tempcheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_temprackingvalve",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_temprackingvalve",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_ts02",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_ts02",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_ts02num",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_ts02num",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tso2",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_tso2",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_volumecheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_volumecheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_volumeunder500",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_volumeunder500",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_winery",
											"type": "String"
										},
										"sink": {
											"name": "ww_winery",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "PreBottlingAnalysis",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_prebottlinganalysis2",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Pre-Bottling Analysis",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_prebottlinganalysis]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz;lab.ml@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Pre-Bottling Analysis",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz;lab.ml@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Stored procedure Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_prebottlinganalysis]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_prebottlinganalysisgasadjustments')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PrebottlingAnalysisGasAdjustments",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_adjustmentoff",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_adjustmentoff",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_adjustmenton",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_adjustmenton",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_co2",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_co2",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_co2gasused",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_co2gasused",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_co2resultrequired",
											"type": "String"
										},
										"sink": {
											"name": "ww_co2resultrequired",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_co2retest",
											"type": "String"
										},
										"sink": {
											"name": "ww_co2retest",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_customertankname",
											"type": "String"
										},
										"sink": {
											"name": "ww_customertankname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_DeleteLine",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_do",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_do",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_doadjustmentoff",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_doadjustmentoff",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_doadjustmenton",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_doadjustmenton",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_dogasused",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_dogasused",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_doorco2",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_doorco2",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_dorestest",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_dorestest",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_doresultrequired",
											"type": "String"
										},
										"sink": {
											"name": "ww_doresultrequired",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_etxt",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_etxt",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_gas_used",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_gas_used",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_off",
											"type": "String"
										},
										"sink": {
											"name": "ww_off",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_on",
											"type": "String"
										},
										"sink": {
											"name": "ww_on",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operator",
											"type": "String"
										},
										"sink": {
											"name": "ww_operator",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_pbagasadjustmentsname",
											"type": "String"
										},
										"sink": {
											"name": "ww_pbagasadjustmentsname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_prebottlinganalysisgasadjustmentsid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_prebottlinganalysisgasadjustmentsid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_resultrequired",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_resultrequired",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_run",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_run",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_tanker",
											"type": "String"
										},
										"sink": {
											"name": "ww_tanker",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tankerlookup",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_tankerlookup",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_tankerlookuptext",
											"type": "String"
										},
										"sink": {
											"name": "ww_tankerlookuptext",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_totalsparging",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_totalsparging",
											"type": "Decimal"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "PrebottlingAnalysisGasAdjustments",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_prebottlinganalysisgasadjustments1",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PrebottlingAnalysisGasAdjustments",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_prebottlinganalysisgasadjustments]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "PrebottlingAnalysisGasAdjustments",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_prebottlinganalysisgasadjustments]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_prebottlinganalysisrecheck')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Pre-Bottling Analysis Recheck",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "crc5d_fiapprovedby",
											"type": "String"
										},
										"sink": {
											"name": "crc5d_fiapprovedby",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "crc5d_fichange",
											"type": "Int32"
										},
										"sink": {
											"name": "crc5d_fichange",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "crc5d_refract",
											"type": "Boolean"
										},
										"sink": {
											"name": "crc5d_refract",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "crc5d_refractvalue",
											"type": "Decimal"
										},
										"sink": {
											"name": "crc5d_refractvalue",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_alc",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_alc",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_alcnum",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_alcnum",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_alcoholbydistil",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_alcoholbydistil",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_basedo",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_basedo",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_co2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_co2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_customertankname",
											"type": "String"
										},
										"sink": {
											"name": "ww_customertankname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_density",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_density",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_distill",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_distill",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_distillnum",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_distillnum",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_etxt",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_etxt",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_extraanalysis",
											"type": "String"
										},
										"sink": {
											"name": "ww_extraanalysis",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_fi",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fi",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_fiissueemailsent",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_fiissueemailsent",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_fso2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_fso2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_greentag",
											"type": "String"
										},
										"sink": {
											"name": "ww_greentag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_initials",
											"type": "String"
										},
										"sink": {
											"name": "ww_initials",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_notes",
											"type": "String"
										},
										"sink": {
											"name": "ww_notes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operator",
											"type": "String"
										},
										"sink": {
											"name": "ww_operator",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_pbatankerlookup",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_pbatankerlookup",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_ph",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_ph",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_prebottlinganalysisrecheckid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_prebottlinganalysisrecheckid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_prebottlinganalysisrechecksummaryname",
											"type": "String"
										},
										"sink": {
											"name": "ww_prebottlinganalysisrechecksummaryname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_run",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_run",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_tanker",
											"type": "String"
										},
										"sink": {
											"name": "ww_tanker",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tankerlookup",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_tankerlookup",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_tankerlookuptext",
											"type": "String"
										},
										"sink": {
											"name": "ww_tankerlookuptext",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_temp",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_temp",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tempcheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_tempcheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_tso2",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_tso2",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_tso2mg",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tso2mg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tso2num",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_tso2num",
											"type": "Decimal"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "PreBottlingAnalysisRecheck",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_prebottlinganalysisrecheck1",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Pre-Bottling Analysis Recheck",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "usp_ww_prebottlinganalysisrecheck"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Pre-Bottling Analysis Recheck",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_prebottlinganalysisrecheck]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_prebottlinganalysissignoff')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PrebottlingAnalysisSignOff",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "crc5d_additionalchargesinformation",
											"type": "String"
										},
										"sink": {
											"name": "crc5d_additionalchargesinformation",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "crc5d_chargingcomplete",
											"type": "Boolean"
										},
										"sink": {
											"name": "crc5d_chargingcomplete",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_additionaltransferszlatrad",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_additionaltransferszlatrad",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_alcoholrecheckzlaaa",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_alcoholrecheckzlaaa",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_authorisation",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_authorisation",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_authorisingsignature",
											"type": "String"
										},
										"sink": {
											"name": "ww_authorisingsignature",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bottleavailableat",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_bottleavailableat",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_cellarstafftime",
											"type": "String"
										},
										"sink": {
											"name": "ww_cellarstafftime",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cellarstafftimezrsollc",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_cellarstafftimezrsollc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_co2saturationandtolerance",
											"type": "String"
										},
										"sink": {
											"name": "ww_co2saturationandtolerance",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_co2dorecheckzlagas",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_co2dorecheckzlagas",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_eststarttime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_eststarttime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_etxt",
											"type": "String"
										},
										"sink": {
											"name": "ww_etxt",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_fiissueemailsent",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_fiissueemailsent",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_filterabilitycasechargezpfsc",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_filterabilitycasechargezpfsc",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_filterabilitycasechargezpfsc2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_filterabilitycasechargezpfsc2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_filterabilityretestzlafi",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_filterabilityretestzlafi",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_goodtogo",
											"type": "String"
										},
										"sink": {
											"name": "ww_goodtogo",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_instructionfromwinemaker",
											"type": "String"
										},
										"sink": {
											"name": "ww_instructionfromwinemaker",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operator",
											"type": "String"
										},
										"sink": {
											"name": "ww_operator",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_pmsaddition",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_pmsaddition",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_prebottlinganalysissignoffid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_prebottlinganalysissignoffid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_run",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_run",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_signoff",
											"type": "String"
										},
										"sink": {
											"name": "ww_signoff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_so2recheckfreeftzlaso2",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_so2recheckfreeftzlaso2",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_soetxt",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_soetxt",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_sogoodtogo",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_sogoodtogo",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_sowinemakertobepresentfortaste",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_sowinemakertobepresentfortaste",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_spargeinlinezpssp",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_spargeinlinezpssp",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_sparkling",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_sparkling",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_startupalcoholpass",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_startupalcoholpass",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_startupalcoholreading",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_startupalcoholreading",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_tanktransferzlatran",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_tanktransferzlatran",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_tempadjustmentzpcwt",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_tempadjustmentzpcwt",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_winemaker",
											"type": "String"
										},
										"sink": {
											"name": "ww_winemaker",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_winemakerinstructions",
											"type": "String"
										},
										"sink": {
											"name": "ww_winemakerinstructions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_winemakertobepresentfortaste",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_winemakertobepresentfortaste",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_winemakertobepresentfortasteoff",
											"type": "String"
										},
										"sink": {
											"name": "ww_winemakertobepresentfortasteoff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_wwsupplieddryicezpsdi",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_wwsupplieddryicezpsdi",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "PrebottlingAnalysisSignOff",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_prebottlinganalysissignoff12",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PrebottlingAnalysisSignOff",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_ww_prebottlinganalysissignoff]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure BOM",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "PrebottlingAnalysisSignOff",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_prebottlinganalysissignoff]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_prebottlinganalysissulphuradj')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Pre-Bottling Analysis Sulphur Adjustment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_customertankname",
											"type": "String"
										},
										"sink": {
											"name": "ww_customertankname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_DeleteLine",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_etxt",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_etxt",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_initial1",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_initial1",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_initial2",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_initial2",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_operator",
											"type": "String"
										},
										"sink": {
											"name": "ww_operator",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_pbasulphuradjustmentsname",
											"type": "String"
										},
										"sink": {
											"name": "ww_pbasulphuradjustmentsname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_pmsbatchexpirydate",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_pmsbatchexpirydate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_pmsg",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_pmsg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_pms_batch",
											"type": "String"
										},
										"sink": {
											"name": "ww_pms_batch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_prebottlinganalysissulphuradjid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_prebottlinganalysissulphuradjid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_requiredso2result",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_requiredso2result",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_retestresult",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_retestresult",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_run",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_run",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_so2increasesppm",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_so2increasesppm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_spargetime",
											"type": "String"
										},
										"sink": {
											"name": "ww_spargetime",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tanker",
											"type": "String"
										},
										"sink": {
											"name": "ww_tanker",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tankerlookup",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_tankerlookup",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_tankerlookuptext",
											"type": "String"
										},
										"sink": {
											"name": "ww_tankerlookuptext",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_totalsulphurresult",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_totalsulphurresult",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_winevolume",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_winevolume",
											"type": "Decimal"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "PrebottlingAnalysisSulphurAdjustments",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "WWSQL003_PrebottlingAnalysisSulphurAdjustments",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Pre-Bottling Analysis Sulphur Adjustment",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "usp_ww_prebottlinganalysissulphuradj"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP Fail Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Email on Failure",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Pre-Bottling Analysis Sulphur Adjustment",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_prebottlinganalysissulphuradj]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_qcendofrun')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "QC End of Run",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_bottlecounter",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlecounter",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_bottlingfromtextlookup",
											"type": "String"
										},
										"sink": {
											"name": "ww_BottlingFromtextlookup",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bottlingto",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_BottlingTo",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_checktime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_CheckTime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_comments",
											"type": "String"
										},
										"sink": {
											"name": "ww_Comments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_endofrunsamples",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_endofrunsamples",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_finalbottlecount",
											"type": "String"
										},
										"sink": {
											"name": "ww_FinalBottleCount",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_endofsamples",
											"type": "String"
										},
										"sink": {
											"name": "ww_endofsamples",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_flowmeter",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_flowmeter",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_flowmetercheck",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_Flowmetercheck",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_glassfragmentscheck",
											"type": "String"
										},
										"sink": {
											"name": "ww_GlassFragmenstCheck",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_inbottle",
											"type": "Int32"
										},
										"sink": {
											"name": "Ww_Inbottle",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_lasercounter",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_lasercounter",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_magnumwhitetape",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_magnumwhitetape",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_qcendofrunid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_qcendofrunid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_qcendofrunname",
											"type": "String"
										},
										"sink": {
											"name": "ww_qcendofrunname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rejectcounter",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_rejectcounter",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_rinseheadmedium",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_Rinseheadmedium",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_rinsergassupplyccp1",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_RinserGasSupplyCCP1",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_run",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_run",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_runendtime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_runendtime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_velcorinproductionmodeoff",
											"type": "String"
										},
										"sink": {
											"name": "ww_VelcorinProductionmodeoff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_velcorinsystemdrained",
											"type": "String"
										},
										"sink": {
											"name": "ww_VelcorinSystemdrained",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "QCEndofRun",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_qcendofrun",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "QC End of Run",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[usp_ww_qcendofrun]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Data Copy fail email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "QC End of Run",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "SP Failed Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_qcendofrun]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_qchourlycheck')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "QC Hourly Check",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_authorisedsig",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_authorisedsig",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_co2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_co2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_collectexportsamples",
											"type": "String"
										},
										"sink": {
											"name": "ww_collectexportsamples",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_comments",
											"type": "String"
										},
										"sink": {
											"name": "ww_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_do2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_DO2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_dco2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_DCO2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_do",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_do",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_exportsamplespicked",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_exportsamplespicked",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_flowmeterreading",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_flowmeterreading",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_foreignmatter",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_foreignmatter",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_micro",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_micro",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_qcbottlecode",
											"type": "String"
										},
										"sink": {
											"name": "ww_qcbottlecode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_qchourlycheckid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_qchourlycheckid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_qcscrewcapscode",
											"type": "String"
										},
										"sink": {
											"name": "ww_qcscrewcapscode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_run",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_run",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_samplessig",
											"type": "String"
										},
										"sink": {
											"name": "ww_samplessig",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "crc5d_shakendo",
											"type": "Decimal"
										},
										"sink": {
											"name": "crc5d_ShakenDO",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_startuptimebottlelasercodetime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_StartUpTimebottlelasercodetime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_tankinuse",
											"type": "String"
										},
										"sink": {
											"name": "ww_tankinuse",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tankjointscheckedforleaks",
											"type": "String"
										},
										"sink": {
											"name": "ww_tankjointscheckedforleaks",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_timeofauthorisedauditcheck",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_timeofauthorisedauditcheck",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_timeofcheck",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_timeofcheck",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_visualcolourmatchtankbtl",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_visualcolourmatchtankbtl",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_winetemperaturecbox",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_Winetemperaturecbox",
											"type": "Decimal"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "QCHourlyCheck",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_qchourlycheck1",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "QC Hourly Check",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[usp_ww_qchourlycheck]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Data Copy fail email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "QC Hourly Check",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "mWWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "SP Failed Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "WWSQL_Admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_qchourlycheck]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_qcrecheck')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "QC Re check",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_dco2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_DCO2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_alcoholinbottle",
											"type": "String"
										},
										"sink": {
											"name": "ww_alcoholinbottle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_alcoholpercentage",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_alcoholpercentage",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_bottlealcoholfirsttank",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlealcoholfirsttank",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_co2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_co2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_comments",
											"type": "String"
										},
										"sink": {
											"name": "ww_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_deleteline",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_deleteline",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_do",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_do",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_do2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_DO2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_foreignmatter",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_foreignmatter",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_qcrecheckid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_qcrecheckid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_qcrecheckname",
											"type": "String"
										},
										"sink": {
											"name": "ww_qcrecheckname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										},
										"sink": {
											"name": "ww_reasonfordeletion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_refractbtl",
											"type": "String"
										},
										"sink": {
											"name": "ww_refractbtl",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_run",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_run",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_shakendo",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_shakendo",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_runname",
											"type": "String"
										},
										"sink": {
											"name": "ww_runname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_timeofcheck",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_timeofcheck",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_visualcolourmatchtankbtl",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_visualcolourmatchtankbtl",
											"type": "Boolean"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "QCRecheck",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_qcrecheck",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "QC Re check",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[usp_ww_qcrecheck]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Data Copy fail email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "QC Re check",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "SP Failed Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_qcrecheck]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ww_qcstartup')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "QC Start Up",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Clean",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CommonDataServiceForAppsSource"
							},
							"sink": {
								"type": "SqlServerSink",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "createdon",
											"type": "DateTime"
										},
										"sink": {
											"name": "createdon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "modifiedon",
											"type": "DateTime"
										},
										"sink": {
											"name": "modifiedon",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "statuscode",
											"type": "Int32"
										},
										"sink": {
											"name": "statuscode",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_alcoholinbottle",
											"type": "String"
										},
										"sink": {
											"name": "ww_alcoholinbottle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_alcoholintank",
											"type": "String"
										},
										"sink": {
											"name": "ww_alcoholintank",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_alcoholpercentage",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_alcoholpercentage",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_atpswabsnottaken",
											"type": "String"
										},
										"sink": {
											"name": "ww_ATPswabsnottaken",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_blsampleattachedtospecsheet",
											"type": "String"
										},
										"sink": {
											"name": "ww_blsampleattachedtospecsheet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_startuptimebottlelasercodetime",
											"type": "DateTime"
										},
										"sink": {
											"name": "ww_StartUpTimebottlelasercodetime",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ww_bottlealcoholfirsttank",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_bottlealcoholfirsttank",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_bottlecodeandguiderailsset",
											"type": "String"
										},
										"sink": {
											"name": "ww_bottlecodeandguiderailsset",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_bottlecoderrunningandlegible",
											"type": "String"
										},
										"sink": {
											"name": "ww_bottlecoderrunningandlegible",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_codeheight",
											"type": "String"
										},
										"sink": {
											"name": "ww_codeheight",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_comments",
											"type": "String"
										},
										"sink": {
											"name": "ww_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_countzeroed",
											"type": "String"
										},
										"sink": {
											"name": "ww_countzeroed",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_cunos",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_cunos",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_cunosyesno",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_cunosyesno",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_customertankername",
											"type": "String"
										},
										"sink": {
											"name": "ww_customertankername",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_dco2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_DCO2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_do",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_do",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_co2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_co2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_do2",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_DO2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_foreignmatter",
											"type": "String"
										},
										"sink": {
											"name": "ww_foreignmatter",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_microsneeded",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_microsneeded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_microsneededyesno",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_microsneededyesno",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_noticerequired",
											"type": "String"
										},
										"sink": {
											"name": "ww_noticerequired",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_operatorcode",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_operatorcode",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_productionline",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_productionline",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_qcstartupid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_qcstartupid",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_qcstartupname",
											"type": "String"
										},
										"sink": {
											"name": "ww_qcstartupname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_refract",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_refract",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_refractbtl",
											"type": "String"
										},
										"sink": {
											"name": "ww_refractbtl",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_refracttank",
											"type": "String"
										},
										"sink": {
											"name": "ww_refracttank",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_rockstopper",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_rockstopper",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_rockstopperyesno",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_rockstopperyesno",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_run",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_run",
											"type": "Guid"
										}
									},
									{
										"source": {
											"name": "ww_runname",
											"type": "String"
										},
										"sink": {
											"name": "ww_runname",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_tanker",
											"type": "String"
										},
										"sink": {
											"name": "ww_tanker",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ww_visualcolourmatchtankbtl",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_visualcolourmatchtankbtl",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ww_wecs",
											"type": "Int32"
										},
										"sink": {
											"name": "ww_wecs",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_wecsyesno",
											"type": "Boolean"
										},
										"sink": {
											"name": "ww_wecsyesno",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "ww_winetemperaturefiller",
											"type": "Decimal"
										},
										"sink": {
											"name": "ww_WineTemperatureFiller",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ww_winemakersignatureid",
											"type": "Guid"
										},
										"sink": {
											"name": "ww_winemakersignatureid",
											"type": "Guid"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "QCStartUp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwsql003_ww_qcstartup",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge Statement",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "QC Start Up",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[usp_ww_qcstartup]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Data Copy fail email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "QC Start Up",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "SP Failed Email",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Merge Statement",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": "https://prod-24.australiasoutheast.logic.azure.com:443/workflows/d77213c4f1ec4ab89956fb3256ee6f0b/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JdvR2R2i-AADVzAwGjO9cFUL5shYwrH-ITahY10Tw-0",
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}",
								"Subject": "An error has occurred!",
								"ErrorMessage": "The ADF pipeline has crashed! Please check the logs.",
								"EmailTo": "wwsql_admins@wineworks.co.nz"
							}
						}
					},
					{
						"name": "Clean",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_clean_ww_qcstartup]"
						},
						"linkedServiceName": {
							"referenceName": "WWSQL003",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": []
		}
	]
}